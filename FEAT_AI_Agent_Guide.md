
# FEAT SNIPER: Documentation for AI Programming Agents

This document serves as a guide for AI agents (like Antigravity, Cline, or Roo) to understand the FEAT SNIPER ecosystem and maintain consistency.

## 1. System Architecture
The system is a hybrid of MQL5 (MT5 Visuals/Data) and Python (ML/Logic).

- **MT5 (MQL5):** Handles real-time execution, technical indicators (CEMAs, PVP), and the "Glass HUD" (Cockpit V2).
- **Python (MCP Brain):** Handles market regime analysis, neural risk management, and long-term memory (RAG).
- **ZMQ Bridge:** High-speed asynchronous communication.
    - PUB 5555: MT5 -> Python (Market Features)
    - SUB 5556: Python -> MT5 (HUD Updates/Signals)

## 2. The "System Re-Genesis" Protocol
Whenever structural changes are made (e.g., adding new NN inputs), you MUST follow this protocol to avoid "File Not Found" or "Dimension Mismatch" errors:

1.  **Phase 1: Code Sync:** Update `CInterop.mqh` (MQL5) and `data_collector.py` (Python) to match the new feature set.
2.  **Phase 2: Build & Deploy:** 
    - Compile MQL5 via `deploy_indicator.ps1`.
    - Rebuild Docker via `docker compose build --no-cache`.
3.  **Phase 3: Re-training:**
    - Run `seed_history.py` to prime the database.
    - Run `train_models.py` to update model weights to the new dimension.
4.  **Phase 4: Nexus Startup:** Run `nexus.bat` to launch the synchronized ecosystem.

## 3. Data Schema Consistency
The current standard for `market_data` table and `FEATURE_NAMES` is **28 features**:
- Standard: Open, High, Low, Close, Volume
- Alpha: RSI, ATR, EMA_Fast, EMA_Slow
- FSM: Score, State, Liquidity_Ratio, Volatility_ZScore
- Physics: Momentum, Entropy, Cycle_Phase, Mass_Flow, Regime_Norm, Acceptance, Wick_Stress, POC_ZScore, CVD_Accel
- Ribbon: Micro_Comp, Micro_Slope, Oper_Slope, Macro_Slope, Bias_Slope, Fan_Bullish

## 4. Key Files & Responsibilities
- `InstitutionalPVP.mq5`: Main MT5 Indicator. Combines PVP + Ribbon + HUD + ZMQ.
- `CInterop.mqh`: The ZMQ interface. Must use the OOP Class wrapper (Context/Socket).
- `data_collector.py`: SQL Database manager with auto-migration.
- `hybrid_model.py`: PyTorch architecture. `dense_input_dim` must match `FEATURE_NAMES` length.
- `nexus_control.py`: Finite State Machine managing Autonomous/Supervised modes.

## 5. Coding Rules (Cascade Consistency)
- **Proactive Impact Analysis:** If you change a variable in MQL5 that is sent via ZMQ, you MUST update the Python `BuildJson` equivalent and the `DataCollector` schema immediately.
- **Error Handling:** Always check for `NULL` pointers in MQL5 and use `try-except` in Python ZMQ decoders.
- **Design:** Visuals must be "Glass Morphic" / "Premium Cyberpunk" style. Grey/Generic colors are Forbidden.

---
*Generated by Antigravity Prime*
